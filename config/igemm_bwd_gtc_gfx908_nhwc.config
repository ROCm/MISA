[codegen]
arch = 'gfx908'
code_object = 'cov3'
mode = 'flat'

#########################################################################################
#--------------------------- 256x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 256x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 256x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 256x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 256x64x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 4
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 256x64x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 4
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 256x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 256x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 256x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 256x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 256x32x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 256x32x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 256x32x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 4
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 256x32x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 32
gemm_k_per_block         = 4
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 128x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

# this is slightly slower than above, but no big difference
# #--------------------------- 128x128x16
# [igemm_bwd_gtc]
# gemm_m_per_block         = 128
# gemm_n_per_block         = 128
# gemm_k_per_block         = 16
# wave_tile_m              = 32
# wave_step_m              = 1
# wave_repeat_m            = 2
# wave_tile_n              = 32
# wave_step_n              = 1
# wave_repeat_n            = 2
# wave_tile_k              = 2
# tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
# tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
# tensor_b_thread_lengths  = [1, 2, 4, 1]       # ExKxC0xC1
# tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
# direction                = "bwd"
# precision                = "fp32"
# tensor_layout            = 'nhwc'
# nxb                      = 0
# nxe                      = 1

#--------------------------- 128x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

##--------------------------- 128x128x16
#[igemm_bwd_gtc]
#gemm_m_per_block         = 128
#gemm_n_per_block         = 128
#gemm_k_per_block         = 16
#wave_tile_m              = 32
#wave_step_m              = 1
#wave_repeat_m            = 2
#wave_tile_n              = 32
#wave_step_n              = 1
#wave_repeat_n            = 2
#wave_tile_k              = 2
#tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
#tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
#tensor_b_thread_lengths  = [1, 2, 4, 1]       # ExKxC0xC1
#tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
#direction                = "bwd"
#precision                = "fp32"
#tensor_layout            = 'nhwc'
#nxb                      = 0
#nxe                      = 0

#--------------------------- 128x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 128x128x8. padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 128x128x8. padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x128x4. padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 4
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 128x128x4. padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 4
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1


#########################################################################################
#--------------------------- 128x64x32, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1,16, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 128x64x32, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1,16, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 128x64x32, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1,16, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x64x32, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1,16, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 128x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 128x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 128x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1


#--------------------------- 128x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 128x64x16, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1, 8, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 128x64x16, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1, 8, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 128x64x16, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1, 8, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x64x16, pass_through
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_pass_through    = 1
tensor_a_thread_lengths  = [1, 8, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 2, 4, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 128x64x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 128x64x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x64x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 4
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 128x64x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 4
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 128x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 128x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 128x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 8, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 128x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 128x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 128x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 128x32x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 128x32x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 8
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 128x32x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 4
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 128x32x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 4
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 64x256x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 256
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x256x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 256
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x256x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 256
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x256x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 256
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 64x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x128x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 2
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 64x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 64x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x64x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 64x64x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 8
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 64x64x8, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 8
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x64x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 4
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1

#--------------------------- 64x64x4, padded_k
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 64
gemm_k_per_block         = 4
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 1
tensor_a_thread_lengths  = [1, 1, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 1, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
merge_e                  = 1
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 64x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x32x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 64x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x32x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 64]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 64x16x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x16x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x16x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x16x32
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 4, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#--------------------------- 64x16x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 64x16x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 64x16x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 64x16x16
[igemm_bwd_gtc]
gemm_m_per_block         = 64
gemm_n_per_block         = 16
gemm_k_per_block         = 16
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 1
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 2, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 4, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 2, 1, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

#########################################################################################
#--------------------------- 32x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 32
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 32x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 32
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 32x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 32
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 32x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 32
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 32]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

# #--------------------------- 32x64x16
# [igemm_bwd_gtc]
# gemm_m_per_block         = 32
# gemm_n_per_block         = 64
# gemm_k_per_block         = 16
# wave_tile_m              = 16
# wave_step_m              = 1
# wave_repeat_m            = 1
# wave_tile_n              = 16
# wave_step_n              = 1
# wave_repeat_n            = 2
# wave_tile_k              = 4
# tensor_a_thread_lengths  = [1, 2, 1, 1]       # ExKxNB0xNB1
# tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
# tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
# tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
# direction                = "bwd"
# precision                = "fp32"
# tensor_layout            = 'nhwc'
# nxb                      = 0
# nxe                      = 1
# 
# #--------------------------- 32x64x16
# [igemm_bwd_gtc]
# gemm_m_per_block         = 32
# gemm_n_per_block         = 64
# gemm_k_per_block         = 16
# wave_tile_m              = 16
# wave_step_m              = 1
# wave_repeat_m            = 1
# wave_tile_n              = 16
# wave_step_n              = 1
# wave_repeat_n            = 2
# wave_tile_k              = 4
# tensor_a_thread_lengths  = [1, 2, 1, 1]       # ExKxNB0xNB1
# tensor_a_cluster_lengths = [1, 8, 1, 32]      # ExKxNB0xNB1
# tensor_b_thread_lengths  = [1, 4, 1, 1]       # ExKxC0xC1
# tensor_b_cluster_lengths = [1, 4, 1, 64]      # ExKxC0XC1
# direction                = "bwd"
# precision                = "fp32"
# tensor_layout            = 'nhwc'
# nxb                      = 0
# nxe                      = 0

#########################################################################################
#--------------------------- 16x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 16
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1

#--------------------------- 16x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 16
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0

#--------------------------- 16x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 16
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 1
gemm_k_global_split      = 1

#--------------------------- 16x64x32
[igemm_bwd_gtc]
gemm_m_per_block         = 16
gemm_n_per_block         = 64
gemm_k_per_block         = 32
wave_tile_m              = 16
wave_step_m              = 1
wave_repeat_m            = 1
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
wave_tile_k              = 4
tensor_a_thread_lengths  = [1, 4, 1, 1]       # ExKxNB0xNB1
tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
tensor_b_thread_lengths  = [1, 4, 4, 1]       # ExKxC0xC1
tensor_b_cluster_lengths = [1, 8, 1, 16]      # ExKxC0XC1
direction                = "bwd"
precision                = "fp32"
tensor_layout            = 'nhwc'
nxb                      = 0
nxe                      = 0
gemm_k_global_split      = 1

# #--------------------------- 16x64x16
# [igemm_bwd_gtc]
# gemm_m_per_block         = 16
# gemm_n_per_block         = 64
# gemm_k_per_block         = 16
# wave_tile_m              = 16
# wave_step_m              = 1
# wave_repeat_m            = 1
# wave_tile_n              = 16
# wave_step_n              = 1
# wave_repeat_n            = 2
# wave_tile_k              = 4
# tensor_a_thread_lengths  = [1, 2, 1, 1]       # ExKxNB0xNB1
# tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
# tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
# tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
# direction                = "bwd"
# precision                = "fp32"
# tensor_layout            = 'nhwc'
# nxb                      = 0
# nxe                      = 1
# 
# #--------------------------- 16x64x16
# [igemm_bwd_gtc]
# gemm_m_per_block         = 16
# gemm_n_per_block         = 64
# gemm_k_per_block         = 16
# wave_tile_m              = 16
# wave_step_m              = 1
# wave_repeat_m            = 1
# wave_tile_n              = 16
# wave_step_n              = 1
# wave_repeat_n            = 2
# wave_tile_k              = 4
# tensor_a_thread_lengths  = [1, 2, 1, 1]       # ExKxNB0xNB1
# tensor_a_cluster_lengths = [1, 8, 1, 16]      # ExKxNB0xNB1
# tensor_b_thread_lengths  = [1, 4, 2, 1]       # ExKxC0xC1
# tensor_b_cluster_lengths = [1, 4, 1, 32]      # ExKxC0XC1
# direction                = "bwd"
# precision                = "fp32"
# tensor_layout            = 'nhwc'
# nxb                      = 0
# nxe                      = 0
