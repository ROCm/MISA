[codegen]
arch = 'gfx908'
code_object = 'cov3'
mode = 'flat'

# [igemm_bwd_gtc]
# gemm_m_per_block         = 256
# gemm_n_per_block         = 128
# gemm_k_per_block         = 16
# wave_tile_m              = 64
# wave_step_m              = 1
# wave_repeat_m            = 2
# wave_tile_n              = 32
# wave_step_n              = 1
# wave_repeat_n            = 2
# tensor_a_thread_lengths  = [2,  1,  8,  1]      # K0xK1ExC0xC1
# tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
# tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
# tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
# direction                = 'bwd'
# precision                = 'fp32'
# nxb                      = 16                   # for ho*wo = 16x
# nxe                      = 1
# 
# [igemm_bwd_gtc]
# gemm_m_per_block         = 256
# gemm_n_per_block         = 128
# gemm_k_per_block         = 16
# wave_tile_m              = 64
# wave_step_m              = 1
# wave_repeat_m            = 2
# wave_tile_n              = 32
# wave_step_n              = 1
# wave_repeat_n            = 2
# tensor_a_thread_lengths  = [2,  1,  8,  1]      # K0xK1ExC0xC1
# tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
# tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
# tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
# direction                = 'bwd'
# precision                = 'fp32'
# nxb                      = 16                   # for ho*wo = 16x
# nxe                      = 0

[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  8,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 1

[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  8,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 0

[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  8,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  2,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 1

[igemm_bwd_gtc]
gemm_m_per_block         = 256
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 64
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 16
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  8,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  2,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 0


[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 1

[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 0


[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 64
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 8
wave_step_n              = 2
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  2,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 1

[igemm_bwd_gtc]
gemm_m_per_block         = 128
gemm_n_per_block         = 32
gemm_k_per_block         = 16
wave_tile_m              = 32
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 8
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  1,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 1

[igemm_bwd_gtc]
gemm_m_per_block         = 32
gemm_n_per_block         = 128
gemm_k_per_block         = 16
wave_tile_m              = 8
wave_step_m              = 1
wave_repeat_m            = 2
wave_tile_n              = 32
wave_step_n              = 1
wave_repeat_n            = 2
tensor_a_thread_lengths  = [2,  1,  1,  1]      # K0xK1ExC0xC1
tensor_a_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExC0xC1
tensor_b_thread_lengths  = [2,  1,  4,  1]      # K0xK1ExN0xN1B
tensor_b_cluster_lengths = [1,  8,  1, 32]      # K0xK1ExN0xN1B
direction                = 'bwd'
precision                = 'fp32'
nxb                      = 1
nxe                      = 1